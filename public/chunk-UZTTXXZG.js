import{a as zr,b as ye,c as ve,d as Ee,e as Ae}from"./chunk-52VZCON4.js";import{$ as Ke,A as gr,B as mr,C as _r,D as me,E as qe,F as wr,G as b,H as yr,I as vr,J as Er,K as Ar,L as Tr,M as kr,N as br,O as Cr,P as Ir,Q as _e,R as Sr,S as Ue,T as We,U as Pr,V as xr,W as Dr,X as Rr,Y as Mr,Z as Nr,_ as He,a as Qt,aa as Fr,b as Xt,ba as Or,c as Zt,ca as ze,d as L,da as jr,e as Jt,ea as $r,f as Yt,fa as Br,g as er,ga as Lr,h as tr,ha as qr,i as rr,ia as Ur,j as nr,ja as Wr,k as ir,ka as Hr,l as sr,la as Kr,m as X,n as Be,o as or,p as ge,q as Le,r as ar,s as cr,u as lr,v as ur,w as dr,x as hr,y as fr,z as pr}from"./chunk-NG3OQMXN.js";import{a as Ut,b as Wt,c as Ht,e as Kt,f as Vt}from"./chunk-JORQD667.js";import{a as we}from"./chunk-IFYMAZQZ.js";import{a as zt,b as Gt}from"./chunk-XHT5H4Q5.js";import{k as Q,l as pe,m as p}from"./chunk-SC5NDB4K.js";import{k as Mt,l as Nt,m as Ft,n as Ot,o as jt,r as he}from"./chunk-GDMXAEND.js";import{L as fe,M as V,O as qt,S as je,Z as $e,c as $t,h as Oe,s as Bt,u as Lt}from"./chunk-XZBKFFCE.js";import{A as z,Bb as Pt,Ca as ae,Cb as xt,Db as Dt,Eb as Rt,Ha as R,I as yt,Ia as ce,K as vt,N as ie,O as se,P as Re,Qa as le,R as oe,S as D,T as Me,Ya as Ne,Z as B,_a as ue,aa as y,c as H,ca as l,cb as k,db as M,eb as At,f as mt,fb as Tt,gb as kt,h as _t,ia as Et,k as K,l as ne,m as I,mb as bt,n as S,ob as Fe,r as h,ub as G,wb as de,xb as Ct,yb as It,z as wt,zb as St}from"./chunk-DANV5L3K.js";import{a as re,b as De,f as C}from"./chunk-CQCHLVVT.js";var yn=new Map,vn={activated:!1,tokenObservers:[]},En={initialized:!1,enabled:!1};function v(r){return yn.get(r)||Object.assign({},vn)}function Zr(){return En}var An="https://content-firebaseappcheck.googleapis.com/v1";var Tn="exchangeDebugToken",Gr={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},Ci=24*60*60*1e3;var Ve=class{constructor(e,t,n,i,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=n,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return C(this,null,function*(){this.stop();try{this.pending=new Oe,this.pending.promise.catch(t=>{}),yield kn(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new Oe,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function kn(r){return new Promise(e=>{setTimeout(e,r)})}var bn={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},P=new Lt("appCheck","AppCheck",bn);function Jr(r){if(!v(r).activated)throw P.create("use-before-activation",{appName:r.name})}function Yr(n,i){return C(this,arguments,function*({url:r,body:e},t){let s={"Content-Type":"application/json"},a=t.getImmediate({optional:!0});if(a){let m=yield a.getHeartbeatsHeader();m&&(s["X-Firebase-Client"]=m)}let o={method:"POST",body:JSON.stringify(e),headers:s},c;try{c=yield fetch(r,o)}catch(m){throw P.create("fetch-network-error",{originalErrorMessage:m?.message})}if(c.status!==200)throw P.create("fetch-status-error",{httpStatus:c.status});let d;try{d=yield c.json()}catch(m){throw P.create("fetch-parse-error",{originalErrorMessage:m?.message})}let g=d.ttl.match(/^([\d.]+)(s)$/);if(!g||!g[2]||isNaN(Number(g[1])))throw P.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${d.ttl}`});let T=Number(g[1])*1e3,$=Date.now();return{token:d.token,expireTimeMillis:$+T,issuedAtTimeMillis:$}})}function en(r,e){let{projectId:t,appId:n,apiKey:i}=r.options;return{url:`${An}/projects/${t}/apps/${n}:${Tn}?key=${i}`,body:{debug_token:e}}}var Cn="firebase-app-check-database",In=1,Qe="firebase-app-check-store";var Te=null;function Sn(){return Te||(Te=new Promise((r,e)=>{try{let t=indexedDB.open(Cn,In);t.onsuccess=n=>{r(n.target.result)},t.onerror=n=>{var i;e(P.create("storage-open",{originalErrorMessage:(i=n.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=n=>{let i=n.target.result;switch(n.oldVersion){case 0:i.createObjectStore(Qe,{keyPath:"compositeKey"})}}}catch(t){e(P.create("storage-open",{originalErrorMessage:t?.message}))}}),Te)}function Pn(r,e){return xn(Dn(r),e)}function xn(r,e){return C(this,null,function*(){let n=(yield Sn()).transaction(Qe,"readwrite"),s=n.objectStore(Qe).put({compositeKey:r,value:e});return new Promise((a,o)=>{s.onsuccess=c=>{a()},n.onerror=c=>{var d;o(P.create("storage-set",{originalErrorMessage:(d=c.target.error)===null||d===void 0?void 0:d.message}))}})})}function Dn(r){return`${r.options.appId}-${r.name}`}var Xe=new qt("@firebase/app-check");function Ge(r,e){return Bt()?Pn(r,e).catch(t=>{Xe.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function tn(){return Zr().enabled}function rn(){return C(this,null,function*(){let r=Zr();if(r.enabled&&r.token)return r.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var Rn={error:"UNKNOWN_ERROR"};function Mn(r){return $t.encodeString(JSON.stringify(r),!1)}function Ze(r,e=!1){return C(this,null,function*(){let t=r.app;Jr(t);let n=v(t),i=n.token,s;if(i&&!Z(i)&&(n.token=void 0,i=void 0),!i){let c=yield n.cachedTokenPromise;c&&(Z(c)?i=c:yield Ge(t,void 0))}if(!e&&i&&Z(i))return{token:i.token};let a=!1;if(tn()){n.exchangeTokenPromise||(n.exchangeTokenPromise=Yr(en(t,yield rn()),r.heartbeatServiceProvider).finally(()=>{n.exchangeTokenPromise=void 0}),a=!0);let c=yield n.exchangeTokenPromise;return yield Ge(t,c),n.token=c,{token:c.token}}try{n.exchangeTokenPromise||(n.exchangeTokenPromise=n.provider.getToken().finally(()=>{n.exchangeTokenPromise=void 0}),a=!0),i=yield v(t).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?Xe.warn(c.message):Xe.error(c),s=c}let o;return i?s?Z(i)?o={token:i.token,internalError:s}:o=Qr(s):(o={token:i.token},n.token=i,yield Ge(t,i)):o=Qr(s),a&&jn(t,o),o})}function Nn(r){return C(this,null,function*(){let e=r.app;Jr(e);let{provider:t}=v(e);if(tn()){let n=yield rn(),{token:i}=yield Yr(en(e,n),r.heartbeatServiceProvider);return{token:i}}else{let{token:n}=yield t.getToken();return{token:n}}})}function Fn(r,e,t,n){let{app:i}=r,s=v(i),a={next:t,error:n,type:e};if(s.tokenObservers=[...s.tokenObservers,a],s.token&&Z(s.token)){let o=s.token;Promise.resolve().then(()=>{t({token:o.token}),Vr(r)}).catch(()=>{})}s.cachedTokenPromise.then(()=>Vr(r))}function nn(r,e){let t=v(r),n=t.tokenObservers.filter(i=>i.next!==e);n.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=n}function Vr(r){let{app:e}=r,t=v(e),n=t.tokenRefresher;n||(n=On(r),t.tokenRefresher=n),!n.isRunning()&&t.isTokenAutoRefreshEnabled&&n.start()}function On(r){let{app:e}=r;return new Ve(()=>C(this,null,function*(){let t=v(e),n;if(t.token?n=yield Ze(r,!0):n=yield Ze(r),n.error)throw n.error;if(n.internalError)throw n.internalError}),()=>!0,()=>{let t=v(e);if(t.token){let n=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return n=Math.min(n,i),Math.max(0,n-Date.now())}else return 0},Gr.RETRIAL_MIN_WAIT,Gr.RETRIAL_MAX_WAIT)}function jn(r,e){let t=v(r).tokenObservers;for(let n of t)try{n.type==="EXTERNAL"&&e.error!=null?n.error(e.error):n.next(e)}catch{}}function Z(r){return r.expireTimeMillis-Date.now()>0}function Qr(r){return{token:Mn(Rn),error:r}}var Je=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=v(this.app);for(let t of e)nn(this.app,t.next);return Promise.resolve()}};function $n(r,e){return new Je(r,e)}function Bn(r){return{getToken:e=>Ze(r,e),getLimitedUseToken:()=>Nn(r),addTokenListener:e=>Fn(r,"INTERNAL",e),removeTokenListener:e=>nn(r.app,e)}}var Ln="@firebase/app-check",qn="0.8.3";var Un="app-check",Xr="app-check-internal";function Wn(){je(new V(Un,r=>{let e=r.getProvider("app").getImmediate(),t=r.getProvider("heartbeat");return $n(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((r,e,t)=>{r.getProvider(Xr).initialize()})),je(new V(Xr,r=>{let e=r.getProvider("app-check").getImmediate();return Bn(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),$e(Ln,qn)}Wn();var Hn=["localhost","0.0.0.0","127.0.0.1"],$i=typeof window<"u"&&Hn.includes(window.location.hostname);var et=new y("angularfire2.auth.use-emulator"),tt=new y("angularfire2.auth.settings"),rt=new y("angularfire2.auth.tenant-id"),nt=new y("angularfire2.auth.langugage-code"),it=new y("angularfire2.auth.use-device-language"),st=new y("angularfire.auth.persistence"),ot=(r,e,t,n,i,s,a,o)=>Ae(`${r.name}.auth`,"AngularFireAuth",r.name,()=>{let c=e.runOutsideAngular(()=>r.auth());if(t&&c.useEmulator(...t),n&&(c.tenantId=n),c.languageCode=i,s&&c.useDeviceLanguage(),a)for(let[d,g]of Object.entries(a))c.settings[d]=g;return o&&c.setPersistence(o),c},[t,n,i,s,a,o]),on=(()=>{class r{authState;idToken;user;idTokenResult;credential;constructor(t,n,i,s,a,o,c,d,g,T,$,m){let Y=new mt,x=S(void 0).pipe(K(a.outsideAngular),D(()=>s.runOutsideAngular(()=>import("./chunk-BDHZO3MY.js"))),h(()=>Ee(t,s,n)),h(E=>ot(E,s,o,d,g,T,c,$)),Re({bufferSize:1,refCount:!1}));if(he(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=S(null);else{x.pipe(vt()).subscribe();let E=x.pipe(D(u=>u.getRedirectResult().then(_=>_,()=>null)),p,Re({bufferSize:1,refCount:!1})),ee=x.pipe(D(u=>new H(_=>({unsubscribe:s.runOutsideAngular(()=>u.onAuthStateChanged(w=>_.next(w),w=>_.error(w),()=>_.complete()))})))),te=x.pipe(D(u=>new H(_=>({unsubscribe:s.runOutsideAngular(()=>u.onIdTokenChanged(w=>_.next(w),w=>_.error(w),()=>_.complete()))}))));this.authState=E.pipe(Me(ee),ne(a.outsideAngular),K(a.insideAngular)),this.user=E.pipe(Me(te),ne(a.outsideAngular),K(a.insideAngular)),this.idToken=this.user.pipe(D(u=>u?I(u.getIdToken()):S(null))),this.idTokenResult=this.user.pipe(D(u=>u?I(u.getIdTokenResult()):S(null))),this.credential=wt(E,Y,this.authState.pipe(z(u=>!u))).pipe(h(u=>u?.user?u:null),ne(a.outsideAngular),K(a.insideAngular))}return zr(this,x,s,{spy:{apply:(E,ee,te)=>{(E.startsWith("signIn")||E.startsWith("createUser"))&&te.then(u=>Y.next(u))}}})}static \u0275fac=function(n){return new(n||r)(l(ye),l(ve,8),l(ae),l(le),l(pe),l(et,8),l(tt,8),l(rt,8),l(nt,8),l(it,8),l(st,8),l(Q,8))};static \u0275prov=B({token:r,factory:r.\u0275fac,providedIn:"any"})}return r})();var Xn="@firebase/firestore-compat",Zn="0.3.30";function ht(r,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new L("invalid-argument",`Invalid options passed to function ${r}(): You cannot specify both "merge" and "mergeFields".`);return e}function an(){if(typeof Uint8Array>"u")throw new L("unimplemented","Uint8Arrays are not available in this environment.")}function cn(){if(!tr())throw new L("unimplemented","Blobs are unavailable in Firestore in this environment.")}var ke=class r{constructor(e){this._delegate=e}static fromBase64String(e){return cn(),new r(me.fromBase64String(e))}static fromUint8Array(e){return an(),new r(me.fromUint8Array(e))}toBase64(){return cn(),this._delegate.toBase64()}toUint8Array(){return an(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function at(r){return Jn(r,["next","error","complete"])}function Jn(r,e){if(typeof r!="object"||r===null)return!1;let t=r;for(let n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}var ct=class{enableIndexedDbPersistence(e,t){return ur(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return dr(e._delegate)}clearIndexedDbPersistence(e){return hr(e._delegate)}},be=class{constructor(e,t,n){this._delegate=t,this._persistenceProvider=n,this.INTERNAL={delete:()=>this.terminate()},e instanceof rr||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Xt("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,n={}){sr(this._delegate,e,t,n)}enableNetwork(){return pr(this._delegate)}disableNetwork(){return gr(this._delegate)}enablePersistence(e){let t=!1,n=!1;return e&&(t=!!e.synchronizeTabs,n=!!e.experimentalForceOwningTab,nr("synchronizeTabs",t,"experimentalForceOwningTab",n)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return fr(this._delegate)}onSnapshotsInSync(e){return jr(this._delegate,e)}get app(){if(!this._appCompat)throw new L("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new W(this,Be(this._delegate,e))}catch(t){throw f(t,"collection()","Firestore.collection()")}}doc(e){try{return new A(this,ge(this._delegate,e))}catch(t){throw f(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new j(this,or(this._delegate,e))}catch(t){throw f(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return Lr(this._delegate,t=>e(new Ce(this,t)))}batch(){return lr(this._delegate),new Ie(new Br(this._delegate,e=>$r(this._delegate,e)))}loadBundle(e){return mr(this._delegate,e)}namedQuery(e){return _r(this._delegate,e).then(t=>t?new j(this,t):null)}},q=class extends Ir{constructor(e){super(),this.firestore=e}convertBytes(e){return new ke(new me(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return A.forKey(t,this.firestore,null)}};function Yn(r){Qt(r)}var Ce=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new q(e)}get(e){let t=N(e);return this._delegate.get(t).then(n=>new F(this._firestore,new _e(this._firestore._delegate,this._userDataWriter,n._key,n._document,n.metadata,t.converter)))}set(e,t,n){let i=N(e);return n?(ht("Transaction.set",n),this._delegate.set(i,t,n)):this._delegate.set(i,t),this}update(e,t,n,...i){let s=N(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,n,...i),this}delete(e){let t=N(e);return this._delegate.delete(t),this}},Ie=class{constructor(e){this._delegate=e}set(e,t,n){let i=N(e);return n?(ht("WriteBatch.set",n),this._delegate.set(i,t,n)):this._delegate.set(i,t),this}update(e,t,n,...i){let s=N(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,n,...i),this}delete(e){let t=N(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},U=class r{constructor(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}fromFirestore(e,t){let n=new Sr(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new O(this._firestore,n),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let n=r.INSTANCES,i=n.get(e);i||(i=new WeakMap,n.set(e,i));let s=i.get(t);return s||(s=new r(e,new q(e),t),i.set(t,s)),s}};U.INSTANCES=new WeakMap;var A=class r{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new q(e)}static forPath(e,t,n){if(e.length%2!==0)throw new L("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new r(t,new X(t._delegate,n,new er(e)))}static forKey(e,t,n){return new r(t,new X(t._delegate,n,e))}get id(){return this._delegate.id}get parent(){return new W(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new W(this.firestore,Be(this._delegate,e))}catch(t){throw f(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=fe(e),e instanceof X?Le(this._delegate,e):!1}set(e,t){t=ht("DocumentReference.set",t);try{return t?He(this._delegate,e,t):He(this._delegate,e)}catch(n){throw f(n,"setDoc()","DocumentReference.set()")}}update(e,t,...n){try{return arguments.length===1?Ke(this._delegate,e):Ke(this._delegate,e,t,...n)}catch(i){throw f(i,"updateDoc()","DocumentReference.update()")}}delete(){return Fr(this._delegate)}onSnapshot(...e){let t=ln(e),n=un(e,i=>new F(this.firestore,new _e(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return ze(this._delegate,t,n)}get(e){let t;return e?.source==="cache"?t=xr(this._delegate):e?.source==="server"?t=Dr(this._delegate):t=Pr(this._delegate),t.then(n=>new F(this.firestore,new _e(this.firestore._delegate,this._userDataWriter,n._key,n._document,n.metadata,this._delegate.converter)))}withConverter(e){return new r(this.firestore,e?this._delegate.withConverter(U.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function f(r,e,t){return r.message=r.message.replace(e,t),r}function ln(r){for(let e of r)if(typeof e=="object"&&!at(e))return e;return{}}function un(r,e){var t,n;let i;return at(r[0])?i=r[0]:at(r[1])?i=r[1]:typeof r[0]=="function"?i={next:r[0],error:r[1],complete:r[2]}:i={next:r[1],error:r[2],complete:r[3]},{next:s=>{i.next&&i.next(e(s))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(n=i.complete)===null||n===void 0?void 0:n.bind(i)}}var F=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new A(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return We(this._delegate,e._delegate)}},O=class extends F{data(e){let t=this._delegate.data(e);return this._delegate._converter||Zt(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},j=class r{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new q(e)}where(e,t,n){try{return new r(this.firestore,b(this._delegate,yr(e,t,n)))}catch(i){throw f(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new r(this.firestore,b(this._delegate,vr(e,t)))}catch(n){throw f(n,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new r(this.firestore,b(this._delegate,Er(e)))}catch(t){throw f(t,"limit()","Query.limit()")}}limitToLast(e){try{return new r(this.firestore,b(this._delegate,Ar(e)))}catch(t){throw f(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new r(this.firestore,b(this._delegate,Tr(...e)))}catch(t){throw f(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new r(this.firestore,b(this._delegate,kr(...e)))}catch(t){throw f(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new r(this.firestore,b(this._delegate,br(...e)))}catch(t){throw f(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new r(this.firestore,b(this._delegate,Cr(...e)))}catch(t){throw f(t,"endAt()","Query.endAt()")}}isEqual(e){return ar(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=Mr(this._delegate):e?.source==="server"?t=Nr(this._delegate):t=Rr(this._delegate),t.then(n=>new J(this.firestore,new Ue(this.firestore._delegate,this._userDataWriter,this._delegate,n._snapshot)))}onSnapshot(...e){let t=ln(e),n=un(e,i=>new J(this.firestore,new Ue(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return ze(this._delegate,t,n)}withConverter(e){return new r(this.firestore,e?this._delegate.withConverter(U.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},lt=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new O(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},J=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new j(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new O(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new lt(this._firestore,t))}forEach(e,t){this._delegate.forEach(n=>{e.call(t,new O(this._firestore,n))})}isEqual(e){return We(this._delegate,e._delegate)}},W=class r extends j{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new A(this.firestore,e):null}doc(e){try{return e===void 0?new A(this.firestore,ge(this._delegate)):new A(this.firestore,ge(this._delegate,e))}catch(t){throw f(t,"doc()","CollectionReference.doc()")}}add(e){return Or(this._delegate,e).then(t=>new A(this.firestore,t))}isEqual(e){return Le(this._delegate,e._delegate)}withConverter(e){return new r(this.firestore,e?this._delegate.withConverter(U.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function N(r){return ir(r,X)}var ut=class r{constructor(...e){this._delegate=new qe(...e)}static documentId(){return new r(Yt.keyField().canonicalString())}isEqual(e){return e=fe(e),e instanceof qe?this._delegate._internalPath.isEqual(e._internalPath):!1}};var dt=class r{constructor(e){this._delegate=e}static serverTimestamp(){let e=Ur();return e._methodName="FieldValue.serverTimestamp",new r(e)}static delete(){let e=qr();return e._methodName="FieldValue.delete",new r(e)}static arrayUnion(...e){let t=Wr(...e);return t._methodName="FieldValue.arrayUnion",new r(t)}static arrayRemove(...e){let t=Hr(...e);return t._methodName="FieldValue.arrayRemove",new r(t)}static increment(e){let t=Kr(e);return t._methodName="FieldValue.increment",new r(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var ei={Firestore:be,GeoPoint:wr,Timestamp:Jt,Blob:ke,Transaction:Ce,WriteBatch:Ie,DocumentReference:A,DocumentSnapshot:F,Query:j,QueryDocumentSnapshot:O,QuerySnapshot:J,CollectionReference:W,FieldPath:ut,FieldValue:dt,setLogLevel:Yn,CACHE_SIZE_UNLIMITED:cr};function ti(r,e){r.INTERNAL.registerComponent(new V("firestore-compat",t=>{let n=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(n,i)},"PUBLIC").setServiceProps(Object.assign({},ei)))}function ri(r){ti(r,(e,t)=>new be(e,t,new ct)),r.registerVersion(Xn,Zn)}ri(we);function ni(r,e=_t){return new H(t=>{let n;return e!=null?e.schedule(()=>{n=r.onSnapshot({includeMetadataChanges:!0},t)}):n=r.onSnapshot({includeMetadataChanges:!0},t),()=>{n?.()}})}function dn(r,e){return ni(r,e)}function ii(r,e){return dn(r,e).pipe(oe(void 0),ie(),h(t=>{let[n,i]=t;return i.exists?n?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function gt(r,e){return dn(r,e).pipe(h(t=>({payload:t,type:"query"})))}var Se=class{ref;afs;constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){let n=this.ref.collection(e),{ref:i,query:s}=pn(n,t);return new xe(i,s,this.afs)}snapshotChanges(){return ii(this.ref,this.afs.schedulers.outsideAngular).pipe(p)}valueChanges(e={}){return this.snapshotChanges().pipe(h(({payload:t})=>e.idField?De(re({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return I(this.ref.get(e)).pipe(p)}};function Pe(r,e){return gt(r,e).pipe(oe(void 0),ie(),h(t=>{let[n,i]=t,s=i.payload.docChanges(),a=s.map(o=>({type:o.type,payload:o}));return n&&JSON.stringify(n.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((o,c)=>{let d=s.find(T=>T.doc.ref.isEqual(o.ref)),g=n?.payload.docs.find(T=>T.ref.isEqual(o.ref));d&&JSON.stringify(d.doc.metadata)===JSON.stringify(o.metadata)||!d&&g&&JSON.stringify(g.metadata)===JSON.stringify(o.metadata)||a.push({type:"modified",payload:{oldIndex:c,newIndex:c,type:"modified",doc:o}})}),a}))}function hn(r,e,t){return Pe(r,t).pipe(se((n,i)=>si(n,i.map(s=>s.payload),e),[]),yt(),h(n=>n.map(i=>({type:i.type,payload:i}))))}function si(r,e,t){return e.forEach(n=>{t.indexOf(n.type)>-1&&(r=oi(r,n))}),r}function ft(r,e,t,...n){let i=r.slice();return i.splice(e,t,...n),i}function oi(r,e){switch(e.type){case"added":if(!(r[e.newIndex]&&r[e.newIndex].doc.ref.isEqual(e.doc.ref)))return ft(r,e.newIndex,0,e);break;case"modified":if(r[e.oldIndex]==null||r[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let t=r.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}else return ft(r,e.newIndex,1,e);break;case"removed":if(r[e.oldIndex]&&r[e.oldIndex].doc.ref.isEqual(e.doc.ref))return ft(r,e.oldIndex,1);break}return r}function fn(r){return(!r||r.length===0)&&(r=["added","removed","modified"]),r}var xe=class{ref;query;afs;constructor(e,t,n){this.ref=e,this.query=t,this.afs=n}stateChanges(e){let t=Pe(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(h(n=>n.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(oe(void 0),ie(),z(([n,i])=>i.length>0||!n),h(([,n])=>n),p)}auditTrail(e){return this.stateChanges(e).pipe(se((t,n)=>[...t,...n],[]))}snapshotChanges(e){let t=fn(e);return hn(this.query,t,this.afs.schedulers.outsideAngular).pipe(p)}valueChanges(e={}){return gt(this.query,this.afs.schedulers.outsideAngular).pipe(h(t=>t.payload.docs.map(n=>e.idField?De(re({},n.data()),{[e.idField]:n.id}):n.data())),p)}get(e){return I(this.query.get(e)).pipe(p)}add(e){return this.ref.add(e)}doc(e){return new Se(this.ref.doc(e),this.afs)}},pt=class{query;afs;constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return!e||e.length===0?Pe(this.query,this.afs.schedulers.outsideAngular).pipe(p):Pe(this.query,this.afs.schedulers.outsideAngular).pipe(h(t=>t.filter(n=>e.indexOf(n.type)>-1)),z(t=>t.length>0),p)}auditTrail(e){return this.stateChanges(e).pipe(se((t,n)=>[...t,...n],[]))}snapshotChanges(e){let t=fn(e);return hn(this.query,t,this.afs.schedulers.outsideAngular).pipe(p)}valueChanges(e={}){return gt(this.query,this.afs.schedulers.outsideAngular).pipe(h(n=>n.payload.docs.map(i=>e.idField?re({[e.idField]:i.id},i.data()):i.data())),p)}get(e){return I(this.query.get(e)).pipe(p)}},ai=new y("angularfire2.enableFirestorePersistence"),ci=new y("angularfire2.firestore.persistenceSettings"),li=new y("angularfire2.firestore.settings"),ui=new y("angularfire2.firestore.use-emulator");function pn(r,e=t=>t){return{query:e(r),ref:r}}var gn=(()=>{class r{schedulers;firestore;persistenceEnabled$;constructor(t,n,i,s,a,o,c,d,g,T,$,m,Y,x,E,ee,te){this.schedulers=c;let u=Ee(t,o,n),_=g;T&&ot(u,o,$,Y,x,E,m,ee),[this.firestore,this.persistenceEnabled$]=Ae(`${u.name}.firestore`,"AngularFirestore",u.name,()=>{let w=o.runOutsideAngular(()=>u.firestore());if(s&&w.settings(s),_&&w.useEmulator(..._),i&&!he(a)){let _n=()=>{try{return I(w.enablePersistence(d||void 0).then(()=>!0,()=>!1))}catch(wn){return typeof console<"u"&&console.warn(wn),S(!1)}};return[w,o.runOutsideAngular(_n)]}else return[w,S(!1)]},[s,_,i])}collection(t,n){let i;typeof t=="string"?i=this.firestore.collection(t):i=t;let{ref:s,query:a}=pn(i,n),o=this.schedulers.ngZone.run(()=>s);return new xe(o,a,this)}collectionGroup(t,n){let i=n||(a=>a),s=this.firestore.collectionGroup(t);return new pt(i(s),this)}doc(t){let n;typeof t=="string"?n=this.firestore.doc(t):n=t;let i=this.schedulers.ngZone.run(()=>n);return new Se(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(n){return new(n||r)(l(ye),l(ve,8),l(ai,8),l(li,8),l(ae),l(le),l(pe),l(ci,8),l(ui,8),l(on,8),l(et,8),l(tt,8),l(rt,8),l(nt,8),l(it,8),l(st,8),l(Q,8))};static \u0275prov=B({token:r,factory:r.\u0275fac,providedIn:"any"})}return r})();var mn=(()=>{let e=class e{constructor(n){this.firestore=n,this.mensajesCollection=this.firestore.collection("chats")}getMessages(){return this.mensajesCollection.valueChanges()}addMessage(n,i){let s=new Date().getTime();this.mensajesCollection.add({user:n,text:i,timestamp:s})}};e.\u0275fac=function(i){return new(i||e)(l(gn))},e.\u0275prov=B({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();var fi=(r,e)=>({"mensaje-propio":r,"mensaje-otro":e});function pi(r,e){if(r&1&&(Tt(0),k(1,"span",10),G(2),M(),kt()),r&2){let t=Fe().$implicit;R(2),de(" ",t.user,":")}}function gi(r,e){if(r&1&&(k(0,"div",6),Ne(1,pi,3,1,"ng-container",7),k(2,"span",8),G(3),M(),k(4,"span",9),G(5),Dt(6,"date"),M()()),r&2){let t=e.$implicit,n=Fe();ue("ngClass",xt(7,fi,t.user===n.usuarioLogueado,t.user!==n.usuarioLogueado)),R(),ue("ngIf",t.user!==n.usuarioLogueado),R(2),de(" ",t.text,""),R(2),de(" ",Rt(6,4,t.timestamp,"dd/MM/yyyy HH:mm"),"")}}var Ss=(()=>{let e=class e{constructor(n,i,s){this.chatService=n,this.authService=i,this._snackBar=s,this.usuarioLogueado=null,this.mensajes=[],this.nuevoMensaje="",this.chatService.getMessages().subscribe(a=>{this.mensajes=a})}ngOnInit(){this.authService.getCurrentUser().subscribe(n=>{n?this.usuarioLogueado=n?.email:this.usuarioLogueado=null}),this.chatService.getMessages().subscribe(n=>{this.mensajes=n.sort((i,s)=>i.timestamp-s.timestamp)})}enviarMensaje(){if(this.usuarioLogueado!=null){if(this.nuevoMensaje.trim()!==""){let n=this.usuarioLogueado||"usuario an\xF3nimo";this.chatService.addMessage(n,this.nuevoMensaje),this.nuevoMensaje=""}}else this.mostrarError("Debes loguearte para utilizar el chat.");console.log("ya sal\xED")}mostrarError(n){this._snackBar.open(n,"Cerrar",{duration:2e3,verticalPosition:"top"})}};e.\u0275fac=function(i){return new(i||e)(ce(mn),ce(zt),ce(Vt))},e.\u0275cmp=Et({type:e,selectors:[["app-chat"]],standalone:!0,features:[Pt],decls:9,vars:2,consts:[[1,"chat-container"],[1,"mensajes-wrapper"],["class","mensaje",3,"ngClass",4,"ngFor","ngForOf"],[1,"input-container"],["placeholder","Escribe un mensaje...",1,"input",3,"ngModelChange","ngModel"],[1,"button",3,"click"],[1,"mensaje",3,"ngClass"],[4,"ngIf"],[1,"text"],[1,"timestamp"],[1,"user"]],template:function(i,s){i&1&&(k(0,"body"),At(1,"app-navbar"),k(2,"div",0)(3,"div",1),Ne(4,gi,7,10,"div",2),M(),k(5,"div",3)(6,"input",4),St("ngModelChange",function(o){return It(s.nuevoMensaje,o)||(s.nuevoMensaje=o),o}),M(),k(7,"button",5),bt("click",function(){return s.enviarMensaje()}),G(8,"Enviar"),M()()()()),i&2&&(R(4),ue("ngForOf",s.mensajes),R(2),Ct("ngModel",s.nuevoMensaje))},dependencies:[jt,Mt,Nt,Ft,Ot,Kt,Ut,Wt,Ht,Gt],styles:['body[_ngcontent-%COMP%]{background-image:url("./media/f4-AZC6R3VF.jpg");margin:0;font-family:Ubuntu,sans-serif;background-size:100% 100%;height:100vh;width:100%}.chat-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:90%;justify-content:center;align-items:center}.mensajes-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;border:1px solid #ccc;border-radius:20px;padding:30px;width:800px;max-height:800px;overflow-y:auto;background-color:#000000a1;margin:0 auto}.mensaje-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;overflow-y:auto;margin-top:100px}.mensaje[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-width:70%;margin-bottom:10px;padding:10px;border-radius:15px}.mensaje-propio[_ngcontent-%COMP%]{background-color:#51ff00;color:#000;align-self:flex-end}.mensaje-otro[_ngcontent-%COMP%]{background-color:#081ccc;color:#fff;align-self:flex-start}.user[_ngcontent-%COMP%]{font-weight:700;text-decoration:underline}.input-container[_ngcontent-%COMP%]{display:flex;align-items:center;padding:5px;margin-top:auto;width:50%}.input[_ngcontent-%COMP%]{flex:1;padding:10px;margin-right:5px;border-radius:20px}.button[_ngcontent-%COMP%]{padding:10px 20px;background-color:#007bff;color:#fff;border:none;cursor:pointer;border-radius:20px}']});let r=e;return r})();export{Ss as a};
